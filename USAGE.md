# Web to Presentation 使用指南

## 概述

Web to Presentation 是一个将HTML网页转换为高质量PPT演示文稿的工具。它提供了一个可视化的前端界面，让你可以轻松配置转换参数并实时监控转换进度。

## 功能特性

### 🎨 图片设置
- **图片分辨率倍数**：1x-5x DPI倍数可选（默认3x = 288 DPI）
- **图片质量**：JPEG格式支持质量调节（50%-100%）
- **图片格式**：支持PNG（无损）和JPEG（压缩）

### 📊 PPT设置
- **导出模式**：
  - **图片模式**：使用高清截图（适合复杂布局和图表）
  - **混合模式**：文字矢量 + 图片背景（推荐，平衡质量与文件大小）
  - **矢量模式**：纯文字矢量（实验性，可能丢失样式）

- **文字提取**：可选择将文字提取为可编辑的矢量文本
- **分离报告**：为每个HTML文件生成独立的PPT
- **合并报告**：同时生成包含所有页面的合并PPT

### 🚀 自动化功能
- **自动文件扫描**：自动扫描项目中的所有HTML文件
- **实时进度监控**：转换过程中实时显示进度
- **一键启动**：运行启动脚本自动打开前端界面

## 快速开始

### 1. 安装依赖

首次使用时，启动脚本会自动检查并安装所需依赖：

```bash
# 启动应用（会自动安装依赖）
python3 start.py
```

或使用npm：

```bash
npm start
```

### 2. 使用前端界面

启动后，浏览器会自动打开前端界面（http://localhost:5000）

#### 步骤：

1. **扫描HTML文件**：点击"扫描HTML文件"按钮，查看项目中的所有HTML文件

2. **配置参数**：
   - 调整图片分辨率（推荐3x，高质量场景可选4x或5x）
   - 选择图片格式（PNG更清晰，JPEG文件更小）
   - 选择导出模式（推荐混合模式）
   - 勾选需要的功能选项

3. **开始转换**：点击"开始转换"按钮启动转换过程

4. **监控进度**：界面会实时显示转换进度和状态信息

5. **查看输出**：转换完成后，PPT文件会保存在 `output/` 目录

## 高级用法

### 命令行转换（传统方式）

如果你更喜欢命令行方式，仍可使用原始脚本：

```bash
# 1. 转换HTML为图片
node src/html-to-images.js

# 2. 转换图片为PPT
python3 src/images-to-ppt.py
```

### 自定义配置

#### 图片转换配置

前端设置会自动保存到 `src/html-to-images-config.json`：

```json
{
  "viewport": {
    "width": 1122,
    "height": 794,
    "deviceScaleFactor": 3
  },
  "imageFormat": "png",
  "imageQuality": 100
}
```

#### PPT导出配置

通过前端界面的PPT设置部分控制：
- 导出模式
- 文字提取
- 报告分离/合并

## 输出目录结构

```
output/
├── images/                          # 生成的图片
│   ├── 版本2_page_01.png
│   ├── 版本2_page_02.png
│   └── ...
├── 版本2.pptx                       # 独立PPT
├── 理想汽车供应链报告.pptx           # 独立PPT
└── combined_reports.pptx            # 合并的PPT
```

## 参数说明

### 图片分辨率倍数 (deviceScaleFactor)

| 倍数 | DPI | 适用场景 | 文件大小 |
|-----|-----|---------|---------|
| 1x | 96 DPI | 快速预览 | 小 |
| 2x | 192 DPI | 一般演示 | 中 |
| 3x | 288 DPI | 高质量演示（推荐）| 中-大 |
| 4x | 384 DPI | 印刷质量 | 大 |
| 5x | 480 DPI | 超高质量 | 很大 |

### 图片格式

- **PNG**：无损格式，质量最高，文件较大
- **JPEG**：有损压缩，文件较小，可调质量

### 导出模式

- **图片模式**：完全使用截图，保留所有视觉效果
- **混合模式**：文字矢量化，背景和图表使用截图（推荐）
- **矢量模式**：尽可能提取所有内容为矢量（实验性）

## 常见问题

### Q: 转换后PPT文件很大怎么办？
A: 尝试以下方法：
- 降低图片分辨率倍数（3x→2x）
- 使用JPEG格式代替PNG
- 降低JPEG质量（100→80）

### Q: 图表显示不清晰？
A:
- 提高分辨率倍数（3x→4x或5x）
- 使用PNG格式
- 确保HTML图表已完全加载

### Q: 文字可以编辑吗？
A:
- 图片模式：文字不可编辑（嵌入图片中）
- 混合模式：部分文字可编辑（提取的文字）
- 矢量模式：文字完全可编辑（实验性）

### Q: 如何停止服务器？
A: 在终端按 `Ctrl+C` 即可停止

## 技术栈

- **前端**：HTML + CSS + JavaScript
- **后端**：Python Flask
- **HTML转换**：Node.js + Playwright
- **PPT生成**：python-pptx

## 许可证

MIT License
